# ğŸ“˜ RAG Chatbot â€” Hybrid Intent + Context-Aware Retrieval System

A Streamlit-based Retrieval-Augmented Generation (RAG) chatbot using hybrid intent routing, conversational memory, and contradiction-safe answering.

---

## ğŸš€ Overview

This project is a complete Retrieval-Augmented Generation (RAG) chatbot built with:

- **Streamlit** for UI
- **LangChain** for embeddings + vector search
- **Groq LLM** for answering
- **Custom Retrieval Agent** with:
  - Repeated question detection
  - Memory-only fast recall
  - Score-based retrieval filtering
  - Query rewriting
- **Conversation Memory**
- **Hybrid Intent Router** powered by LLM (GREETING, GOODBYE, CHITCHAT, CONTROL_COMMAND â†’ handled without retrieval)
- **Contradiction-safe Answer Agent**
- **PDF + Website ingestion pipeline**

The assistant answers **ONLY** using the content from the uploaded PDF or provided URL. It never hallucinates beyond the context and reports contradictions transparently.

---

## âœ¨ Key Features

### ğŸ”¹ 1. Hybrid Intent Classifier (LLM-based)

Routes non-RAG queries before hitting retrieval:

- **GREETING**
- **GOODBYE**
- **CHITCHAT**
- **CONTROL_COMMAND**

All factual questions go directly to the RAG pipeline.

### ğŸ”¹ 2. Retrieval Agent with Smart Logic

Handles all retrieval cases:

- Repeated question detection
- Memory-only answers
- Retrieval failure handling
- End-session intent detection
- Document-based chunk retrieval with score filtering
- Automatic query rewriting for better retrieval

### ğŸ”¹ 3. Answer Agent with Contradiction Detection

The LLM checks for:

- Numerical contradictions
- Opposing statements
- Conflicting claims

And responds neutrally while showing transparent reasoning.

### ğŸ”¹ 4. Conversation Memory

Stores:

- User questions
- Assistant responses
- Embeddings for repeated-question detection
- Context for memory-only answers

### ğŸ”¹ 5. PDF & Webpage Ingestion

- PDF text extraction
- Web HTML extraction + sanitization
- Chunking
- Embedding + Vectorstore creation

Supports multiple pages and multiple document types.

---

## ğŸ“‚ Project Structure

```
ğŸ“¦ rag-chatbot
â”‚
â”œâ”€â”€ app.py                     # Streamlit main UI
â”œâ”€â”€ ingestion.py               # PDF/URL ingestion & vectorstore builder
â”œâ”€â”€ retrieval_agent.py         # Smart retrieval logic + message classification
â”œâ”€â”€ answer_agent.py            # Contradiction-safe answering logic
â”œâ”€â”€ conversation_memory.py     # Conversational memory store
â”œâ”€â”€ hf_llm.py                  # Groq LLM wrapper
â”œâ”€â”€ intent_classifier.py       # LLM-based hybrid intent router
â”‚
â”œâ”€â”€ requirements.txt           # Dependencies
â””â”€â”€ README.md                  # Project documentation
```

---

## ğŸ› ï¸ Installation

### 1. Clone the repository

```bash
git clone https://github.com/jinxforhaters/rag_agent.git
cd rag-chatbot
```

### 2. Install dependencies

```bash
pip install -r requirements.txt
```

### 3. Set up environment variables

Create a `.env` file in the root directory:

```env
QDRANT_URL=https://some-qdrant-instance.cloud
QDRANT_API_KEY=xxxxxxxxxxxxxxxxxxxx
GROQ_API_KEY=xxxxxxxxxxxxxxxxxxxx
```

**ğŸ”‘ Getting API Keys:**

- **Groq API Key**: Sign up at [Groq Console](https://console.groq.com/) and create your free API key
- **Qdrant**: Create a free account at [Qdrant Cloud](https://cloud.qdrant.io/) to get your URL and API key

---

## â–¶ï¸ Usage

### Run Streamlit app:

```bash
streamlit run app.py
```

### In the UI:

1. Upload a PDF or enter a website URL
2. Click **Ingest Source**
3. Ask questions based on the document

### The bot will:

- Detect intent
- Retrieve relevant chunks
- Check contradictions
- Provide clean structured answers
- Show exact sources used

---

## ğŸ§  How It Works (Architecture Overview)

```
ğŸ”¹ 1. User message
         â†“
ğŸ”¹ 2. Intent Classifier
         Handles GREETING / GOODBYE / CHITCHAT / CONTROL_COMMAND
         â†“
ğŸ”¹ 3. Retrieval Agent
         Reformulates query
         Searches vectorstore
         Score-based filtering
         Detects repetition
         Returns top context chunks
         â†“
ğŸ”¹ 4. Answer Agent
         Checks contradictions
         Generates structured answer
         Appends sources
         â†“
ğŸ”¹ 5. Memory Updated
         Helps detect repeated questions & context recall
```

---

## ğŸ”‘ Key Technologies

- **Streamlit** - Interactive web interface
- **LangChain** - LLM orchestration and vector operations
- **Groq** - Fast LLM inference
- **Qdrant** - Vector database for semantic search
- **Python** - Core programming language

---
---

## ğŸ¤ Contributing

Contributions, issues, and feature requests are welcome! Feel free to check the issues page.

---

## ğŸ‘¤ Author

**Mahatshi Shukla**

- GitHub: [jinxforhaters](https://github.com/jinxforhaters)

---

## â­ Show your support

Give a â­ï¸ if this project helped you!